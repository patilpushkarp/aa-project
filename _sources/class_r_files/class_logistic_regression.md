# Logistic Regression

Since the data has been cleaned, it can now be used to create the
models.

``` r
# Load libraries
library(caret)
```

    ## Loading required package: ggplot2

    ## Loading required package: lattice

``` r
library(nnet)
library(MASS)
```

## Import data

To evaluate the model, there should be a set of which the model has not
seen and for which the labels are known. Hence, it is necessary to split
the data into training and testing set.

``` r
# Read training and testing data
train <- read.csv("./../data/classification_data/intermediates/train.csv")
test <- read.csv("./../data/classification_data/intermediates/test.csv")
```

## Model Training

The model is first trained on the training data and then evaluated on
testing data.

``` r
# Model training
multinom.model <- multinom(Rating~., data=train, )
```

    ## # weights:  693 (640 variable)
    ## initial  value 18869.950069 
    ## iter  10 value 17377.541453
    ## iter  20 value 17315.142018
    ## iter  30 value 16971.118371
    ## iter  40 value 16833.284474
    ## iter  50 value 16732.374713
    ## iter  60 value 16672.645134
    ## iter  70 value 16534.413196
    ## iter  80 value 16072.275108
    ## iter  90 value 15421.630207
    ## iter 100 value 14613.421851
    ## final  value 14613.421851 
    ## stopped after 100 iterations

``` r
summary(multinom.model)
```

    ## Call:
    ## multinom(formula = Rating ~ ., data = train)
    ## 
    ## Coefficients:
    ##     (Intercept)           X.1             X
    ## 2  -0.156520609 -2.397570e-06 -2.397570e-06
    ## 3  -0.323442003  7.052125e-05  7.052125e-05
    ## 4  -0.360083103  7.492666e-05  7.492666e-05
    ## 5  -0.380521447  6.945667e-05  6.945667e-05
    ## 6   0.044447709  1.132065e-04  1.132065e-04
    ## 7   0.024764240  3.441243e-05  3.441243e-05
    ## 8   0.264467903  4.852186e-05  4.852185e-05
    ## 9   0.477203613  1.869492e-06  1.869487e-06
    ## 10  0.303596306  5.998167e-06  5.998167e-06
    ## 11  0.134339188  3.516779e-05  3.516779e-05
    ## 12  0.151858903  3.635401e-05  3.635401e-05
    ## 13  0.222906343 -3.032838e-05 -3.032838e-05
    ## 14  0.138362131 -2.887566e-05 -2.887565e-05
    ## 15  0.095054475 -7.088597e-05 -7.088597e-05
    ## 16  0.004395965 -5.768892e-06 -5.768892e-06
    ## 17 -0.165084237 -6.492142e-05 -6.492142e-05
    ## 18 -0.019726935 -2.379637e-04 -2.379637e-04
    ## 19 -0.039931420 -1.091677e-03 -1.091677e-03
    ## 20 -0.089907850 -2.622016e-04 -2.622017e-04
    ## 21 -0.021889599 -3.308979e-04 -3.308979e-04
    ##    Rating.Agency_Egan.Jones.Ratings.Company Rating.Agency_Fitch.Ratings
    ## 2                                0.12407321                -0.034426261
    ## 3                               -0.05943619                -0.094211498
    ## 4                                0.51048192                -0.088587199
    ## 5                                0.96541438                -0.153066939
    ## 6                                0.23151044                 0.006974679
    ## 7                                0.75842485                -0.071589888
    ## 8                               -0.06924943                 0.262930557
    ## 9                               -0.07411648                 0.078530701
    ## 10                              -0.35939623                 0.309726422
    ## 11                               0.19301501                 0.017368831
    ## 12                              -0.34729702                 0.030880772
    ## 13                              -0.48073801                -0.032838175
    ## 14                              -0.34779143                -0.107219046
    ## 15                              -0.23057591                -0.050176869
    ## 16                              -0.24420727                -0.012988235
    ## 17                              -0.26782858                -0.025987258
    ## 18                              -0.03365461                 0.047827690
    ## 19                              -0.01158774                -0.014026988
    ## 20                              -0.01656435                -0.001802918
    ## 21                               0.02484700                 0.002886161
    ##    Rating.Agency_Moody.s.Investors.Service
    ## 2                             -0.051120738
    ## 3                             -0.266236898
    ## 4                             -0.348347163
    ## 5                             -0.312019628
    ## 6                             -0.597842821
    ## 7                             -0.170478754
    ## 8                              0.309509426
    ## 9                              0.176942018
    ## 10                             0.139343951
    ## 11                            -0.145178367
    ## 12                             0.211897392
    ## 13                             0.286863976
    ## 14                             0.333347093
    ## 15                             0.168051614
    ## 16                             0.282952739
    ## 17                             0.140962128
    ## 18                             0.012913071
    ## 19                             0.015994455
    ## 20                             0.002376807
    ## 21                            -0.024393591
    ##    Rating.Agency_Standard...Poor.s.Ratings.Services Binary.Rating  Sector_BusEq
    ## 2                                       -0.19504682    0.06487113  0.0483068109
    ## 3                                        0.09644259    0.22177738  0.1074720198
    ## 4                                       -0.43363066    0.30854286  0.0009839534
    ## 5                                       -0.88084926    0.71275019 -0.0279483186
    ## 6                                        0.40380541    1.63919137 -0.1304612934
    ## 7                                       -0.49159196    1.45850217 -0.0968159869
    ## 8                                       -0.23872265    1.84641749 -0.2333753234
    ## 9                                        0.29584738    2.26386070  0.1055187919
    ## 10                                       0.21392217    1.91348766  0.2879547374
    ## 11                                       0.06913372   -2.31208739  0.0481518560
    ## 12                                       0.25637776   -1.86561761  0.1278329938
    ## 13                                       0.44961855   -1.64199226  0.0060949870
    ## 14                                       0.26002552   -1.56373299 -0.0742593427
    ## 15                                       0.20775564   -1.05051561 -0.0320915812
    ## 16                                      -0.02136127   -1.01643385 -0.0873647762
    ## 17                                      -0.01223053   -0.63804836 -0.0915339717
    ## 18                                      -0.04681308   -0.19697906 -0.0047980014
    ## 19                                      -0.03031115   -0.04964644 -0.0199736300
    ## 20                                      -0.07391738   -0.08383177 -0.0111371223
    ## 21                                      -0.02522917   -0.05230850 -0.0014359050
    ##    Sector_Chems  Sector_Durbl Sector_Enrgy   Sector_Hlth Sector_Manuf
    ## 2  -0.039131036 -2.975929e-02  0.176375211  0.0520823872 -0.112857774
    ## 3  -0.061591295 -5.991771e-02  0.013504821  0.0726326080  0.063339059
    ## 4  -0.088050844  9.946907e-03 -0.128979124  0.2217978617 -0.117341323
    ## 5   0.046789118  7.021145e-02 -0.113789977  0.2077418615 -0.028739911
    ## 6   0.096527234 -2.012484e-02  0.057707761 -0.1647570768  0.048791140
    ## 7  -0.132366972 -5.936856e-02 -0.123028200 -0.0639583240 -0.020897063
    ## 8  -0.023545677 -5.608287e-05  0.219224457 -0.1021979917  0.006919895
    ## 9   0.285561685 -6.154757e-02 -0.021536320 -0.2983969787  0.066755093
    ## 10  0.093835227  1.137214e-02 -0.184167607 -0.1780499942  0.054942259
    ## 11 -0.034371307 -1.388058e-02 -0.029199858 -0.0469210563  0.247810365
    ## 12 -0.097121631  7.368246e-02 -0.011768578 -0.0765364091  0.087574913
    ## 13 -0.008756451 -2.666055e-02 -0.127758197 -0.0559805588  0.150351851
    ## 14  0.162020109 -7.967123e-03 -0.043407450  0.0534223871 -0.045521580
    ## 15 -0.054506002  1.801453e-01  0.140032992 -0.0022896096 -0.070928086
    ## 16 -0.012712755  3.044756e-02  0.030071119  0.0568101103 -0.093887045
    ## 17 -0.046605183 -3.546664e-02  0.063572373  0.1525669581  0.005757340
    ## 18 -0.014321540 -8.603473e-03 -0.030081533  0.0120728581 -0.040351102
    ## 19 -0.008454856 -4.386776e-05  0.018954985 -0.0084784053 -0.017927646
    ## 20 -0.009644261 -1.078875e-02  0.002358886 -0.0043782029 -0.037356194
    ## 21 -0.005378014 -6.532649e-03 -0.000517277  0.0006626738 -0.020715267
    ##    Sector_Money Sector_NoDur Sector_Other Sector_Shops  Sector_Telcm
    ## 2  -0.014455678 -0.054034496 -0.051945047 -0.075124491 -0.0251257845
    ## 3  -0.044127431 -0.079398646 -0.110996833 -0.051399558 -0.0744866158
    ## 4  -0.061776716 -0.085117123 -0.062357714 -0.035931187 -0.1113563664
    ## 5  -0.018138474  0.067959300 -0.393894566 -0.043696598 -0.1922129748
    ## 6  -0.038695872  0.257402454 -0.118006323  0.062523011 -0.1214684156
    ## 7   0.040830240  0.153263747 -0.174269132  0.078056231 -0.0809686667
    ## 8  -0.104324591 -0.133189187  0.244021072  0.016393872 -0.0306691585
    ## 9   0.000276553  0.156616510  0.069089767  0.021993962 -0.0322541801
    ## 10  0.105008749  0.151132758 -0.077670114  0.002495985  0.1762989816
    ## 11 -0.031318995  0.034103300  0.027292435 -0.169900382  0.1622213340
    ## 12  0.041766646 -0.033872842  0.118234606 -0.064840798  0.1192078749
    ## 13  0.020509849 -0.075294897  0.374087753  0.110692948  0.0600446028
    ## 14  0.047692248 -0.083856319  0.122537843  0.183612009  0.0295771026
    ## 15  0.053526654 -0.049559293  0.029585113  0.044714021  0.0631380595
    ## 16  0.078902739 -0.024083852  0.024329203  0.104383611 -0.0155044060
    ## 17 -0.028473579 -0.068784640 -0.019186876 -0.009929605  0.0302747122
    ## 18 -0.012974000 -0.025725941  0.113255962 -0.044669731  0.0575716079
    ## 19 -0.003402601 -0.009759970  0.003056635  0.020480629 -0.0076484793
    ## 20 -0.003517150 -0.012711085 -0.011300183 -0.026761262  0.0405401009
    ## 21 -0.002163184 -0.007887706  0.035276833 -0.015994691 -0.0009563332
    ##    Sector_Utils Current.Ratio Long.term.Debt...Capital Debt.Equity.Ratio
    ## 2  -0.030851426   -0.45458103              -0.21150616       -0.02015133
    ## 3  -0.098472417   -0.60161516              -0.34317008       -0.03888991
    ## 4   0.098098572   -0.63789280              -0.39302387       -0.03199064
    ## 5   0.045197644   -0.67907592              -0.57516751       -0.04346509
    ## 6   0.115009935   -0.84215459              -0.22990343       -0.02949968
    ## 7   0.504286931   -0.23107530              -0.32058934       -0.02362009
    ## 8   0.405266619   -0.09036966              -0.09150484       -0.02078205
    ## 9   0.185126296    0.01200020               0.13826422       -0.03823287
    ## 10 -0.139556820    0.10228152               0.08913537       -0.01927081
    ## 11 -0.059647930    0.53917906               0.22913428       -0.03714344
    ## 12 -0.132300331    0.54758301               0.28690090       -0.02049179
    ## 13 -0.204424991    0.49871095               0.22643816       -0.03751346
    ## 14 -0.205487753    0.49212795               0.30554342       -0.03047729
    ## 15 -0.206713065    0.63049825               0.51236145       -0.03806484
    ## 16 -0.086995547    0.49404678               0.32860489       -0.02136522
    ## 17 -0.117275126    0.47071208               0.07674730       -0.01494783
    ## 18 -0.021102041    0.72310875               0.04936338       -0.03963493
    ## 19 -0.006734215   -0.18326347              -0.01152637       -0.03073189
    ## 20 -0.005212627   -0.05984851               0.32105105       -0.01348978
    ## 21  0.003751921   -0.01078882              -0.01670978       -0.04792395
    ##    Gross.Margin Net.Profit.Margin Asset.Turnover ROE...Return.On.Equity
    ## 2    0.04357327      -0.043711233   -0.242228397            0.003708140
    ## 3    0.04292640      -0.054979414   -0.288609913            0.008533387
    ## 4    0.05113047      -0.062349775   -0.131606477            0.006921467
    ## 5    0.04868842      -0.018928321   -0.008543546            0.008899574
    ## 6    0.04133366      -0.009781937    0.385390652            0.006246889
    ## 7    0.04825827      -0.054178269    0.100317211            0.004171210
    ## 8    0.03007777      -0.053230094    0.016184926            0.004598159
    ## 9    0.02962414      -0.037188004    0.161618034            0.006131630
    ## 10   0.02841513      -0.050450695    0.146621141            0.003799749
    ## 11   0.04075625      -0.061507215   -0.255715187            0.007494236
    ## 12   0.03320423      -0.037465307    0.148475036            0.005771799
    ## 13   0.04243294      -0.001198082    0.253625314            0.006105065
    ## 14   0.04627655      -0.034842390    0.348563048            0.005163869
    ## 15   0.02915060      -0.085145283    0.354357484            0.006813729
    ## 16   0.04097313      -0.065860804   -0.039462584            0.004707153
    ## 17   0.03214087      -0.096711228   -0.236997455            0.007259685
    ## 18   0.02343949      -0.029666014   -0.058506861            0.006717679
    ## 19   0.07910272      -0.058396938   -0.031344563            0.004942684
    ## 20   0.04190582      -0.072843041   -0.118412344            0.008451379
    ## 21   0.02599845       0.079729451   -0.061568242            0.008522718
    ##    Return.On.Tangible.Equity ROA...Return.On.Assets ROI...Return.On.Investment
    ## 2              -0.0003460427            0.074991910               -0.030429087
    ## 3              -0.0005969206            0.143737502               -0.052791836
    ## 4              -0.0001752081            0.110655625               -0.037732458
    ## 5              -0.0004954009            0.018538521               -0.017390169
    ## 6              -0.0004785708           -0.103775465               -0.017686116
    ## 7              -0.0008086146            0.022720209               -0.058167557
    ## 8              -0.0003891886            0.007452565               -0.057436098
    ## 9              -0.0006626158           -0.090298257               -0.039697060
    ## 10             -0.0005029362           -0.135646907               -0.018584505
    ## 11             -0.0014159351            0.125773578               -0.102717804
    ## 12             -0.0003006145           -0.134425041                0.012071984
    ## 13             -0.0012281874           -0.132045084               -0.008116606
    ## 14             -0.0011305156           -0.097454200               -0.013266221
    ## 15             -0.0003731053            0.185623651               -0.151977022
    ## 16             -0.0004303043            0.011600098               -0.079866340
    ## 17             -0.0009053541            0.141569457               -0.079026227
    ## 18             -0.0015784291           -0.045263248               -0.080557433
    ## 19              0.0005656354           -0.214555944               -0.046277656
    ## 20             -0.0008514316            0.075114520               -0.098023614
    ## 21             -0.0002144019           -0.323830919                0.038683834
    ##    Operating.Cash.Flow.Per.Share Free.Cash.Flow.Per.Share
    ## 2                    0.081423738            -0.0033914555
    ## 3                   -0.007190521             0.0271323521
    ## 4                    0.072425592            -0.0264273080
    ## 5                    0.098961118             0.0094774165
    ## 6                    0.020159044             0.0128302173
    ## 7                    0.018244498             0.0144718752
    ## 8                    0.021467007            -0.0054087988
    ## 9                    0.055055579            -0.0034181807
    ## 10                   0.042758589            -0.0157235795
    ## 11                  -0.009553573             0.0127812576
    ## 12                  -0.053390634             0.0350844267
    ## 13                  -0.043478974             0.0429324285
    ## 14                  -0.011736659             0.0003051173
    ## 15                   0.027317946            -0.0007403633
    ## 16                   0.019910208            -0.0354407385
    ## 17                   0.022014896             0.0264991135
    ## 18                  -0.062255682             0.0337082443
    ## 19                   0.085363120             0.0200551580
    ## 20                   0.061688102            -0.0431243598
    ## 21                  -0.074463191            -0.0007148028
    ## 
    ## Std. Errors:
    ##     (Intercept)          X.1            X
    ## 2  0.0007503276 2.753393e-05 2.753393e-05
    ## 3  0.0005719182 2.515023e-05 2.515023e-05
    ## 4  0.0005027038 2.407970e-05 2.407970e-05
    ## 5  0.0005527297 2.336153e-05 2.336153e-05
    ## 6  0.0083660079 2.191703e-05 2.191703e-05
    ## 7  0.0073461773 2.220798e-05 2.220798e-05
    ## 8  0.0078121005 2.199078e-05 2.199078e-05
    ## 9  0.0069494913 2.147296e-05 2.147296e-05
    ## 10 0.0078979551 2.235676e-05 2.235676e-05
    ## 11 0.0012240443 2.284884e-05 2.284884e-05
    ## 12 0.0015864764 2.251556e-05 2.251556e-05
    ## 13 0.0023303459 2.274122e-05 2.274122e-05
    ## 14 0.0026768389 2.276387e-05 2.276387e-05
    ## 15 0.0013729524 2.352936e-05 2.352936e-05
    ## 16 0.0027095001 2.400349e-05 2.400349e-05
    ## 17 0.0016920466 2.772225e-05 2.772225e-05
    ## 18 0.0007209856 3.850399e-05 3.850399e-05
    ## 19 0.0001567856 1.702015e-04 1.702015e-04
    ## 20 0.0002773402 5.603997e-05 5.603997e-05
    ## 21 0.0001698886 6.713573e-05 6.713573e-05
    ##    Rating.Agency_Egan.Jones.Ratings.Company Rating.Agency_Fitch.Ratings
    ## 2                              0.0001154274                1.238377e-04
    ## 3                              0.0002903277                6.129002e-05
    ## 4                              0.0002794048                7.327427e-05
    ## 5                              0.0003008835                5.479488e-05
    ## 6                              0.0057389936                2.156982e-04
    ## 7                              0.0075746517                1.116466e-04
    ## 8                              0.0053262243                5.003131e-04
    ## 9                              0.0035380906                4.226181e-04
    ## 10                             0.0030539456                5.953568e-04
    ## 11                             0.0008712632                1.139026e-04
    ## 12                             0.0005999145                1.107496e-04
    ## 13                             0.0005500337                1.239022e-04
    ## 14                             0.0007156621                1.257843e-04
    ## 15                             0.0007585146                1.162692e-04
    ## 16                             0.0013221844                1.650180e-04
    ## 17                             0.0006989421                4.059748e-05
    ## 18                             0.0001679274                1.168016e-04
    ## 19                             0.0001609617                2.219660e-05
    ## 20                             0.0000715533                6.412324e-05
    ## 21                             0.0000666474                9.728486e-05
    ##    Rating.Agency_Moody.s.Investors.Service
    ## 2                             2.753494e-04
    ## 3                             2.536006e-04
    ## 4                             1.441650e-04
    ## 5                             1.777378e-04
    ## 6                             3.552233e-04
    ## 7                             4.751403e-04
    ## 8                             5.095723e-04
    ## 9                             6.398331e-04
    ## 10                            1.050900e-03
    ## 11                            1.891224e-04
    ## 12                            4.118366e-04
    ## 13                            6.357522e-04
    ## 14                            8.286427e-04
    ## 15                            3.858429e-04
    ## 16                            7.232566e-04
    ## 17                            3.978639e-04
    ## 18                            2.148924e-04
    ## 19                            1.159103e-04
    ## 20                            8.067036e-05
    ## 21                            9.046537e-05
    ##    Rating.Agency_Standard...Poor.s.Ratings.Services Binary.Rating Sector_BusEq
    ## 2                                      0.0004288790  0.0003651931 4.786727e-04
    ## 3                                      0.0005285007  0.0007699829 2.225537e-04
    ## 4                                      0.0005160222  0.0004734118 4.204773e-04
    ## 5                                      0.0002923607  0.0005618375 5.373826e-04
    ## 6                                      0.0028222367  0.0076400384 7.518488e-04
    ## 7                                      0.0004789792  0.0064747059 2.285193e-03
    ## 8                                      0.0016469065  0.0066253003 1.412175e-03
    ## 9                                      0.0034576016  0.0058771104 1.540265e-03
    ## 10                                     0.0033335467  0.0061943713 1.727926e-03
    ## 11                                     0.0003673722  0.0006457267 1.011060e-03
    ## 12                                     0.0006392993  0.0005702252 5.622739e-04
    ## 13                                     0.0011245435  0.0006471046 6.493728e-04
    ## 14                                     0.0011159507  0.0006761499 7.255905e-04
    ## 15                                     0.0005594265  0.0011484545 6.947468e-04
    ## 16                                     0.0006190843  0.0010526234 8.017850e-04
    ## 17                                     0.0006267825  0.0008111237 8.240177e-04
    ## 18                                     0.0003427253  0.0005033734 1.062261e-04
    ## 19                                     0.0002275459  0.0001815994 7.283422e-05
    ## 20                                     0.0001502205  0.0002752948 4.377052e-05
    ## 21                                     0.0002060997  0.0002242226 2.813482e-04
    ##    Sector_Chems Sector_Durbl Sector_Enrgy  Sector_Hlth Sector_Manuf
    ## 2  1.442492e-04 5.420221e-05 2.931919e-04 5.322657e-04 2.879191e-04
    ## 3  1.314737e-04 6.093362e-05 1.732746e-04 2.938838e-04 2.291126e-04
    ## 4  8.833930e-05 5.165593e-05 2.292248e-04 6.878288e-04 1.174235e-04
    ## 5  1.044811e-04 7.085166e-05 3.646108e-04 7.152063e-04 1.732839e-04
    ## 6  3.781780e-04 3.535418e-04 6.370711e-04 3.691085e-04 1.348415e-03
    ## 7  8.803320e-04 4.739436e-04 2.330369e-04 5.243326e-04 2.956563e-03
    ## 8  9.874860e-04 4.647718e-04 3.426517e-04 3.197952e-04 3.268999e-03
    ## 9  9.452618e-04 3.290007e-04 5.238005e-04 2.329628e-04 2.616307e-03
    ## 10 9.433365e-04 3.594739e-04 5.378741e-04 1.735972e-04 2.792892e-03
    ## 11 1.307285e-04 1.095395e-04 3.125902e-04 2.502845e-04 5.674433e-04
    ## 12 1.533703e-04 4.891896e-04 3.073083e-04 1.711385e-04 4.613537e-04
    ## 13 2.056985e-04 3.259836e-04 3.893260e-04 2.287075e-04 6.738024e-04
    ## 14 2.881396e-04 3.240311e-04 4.533950e-04 3.389881e-04 7.284654e-04
    ## 15 2.207423e-04 1.300077e-04 3.120231e-04 1.851731e-04 3.819689e-04
    ## 16 3.654208e-04 8.046602e-05 7.140079e-04 4.637110e-04 7.211299e-04
    ## 17 1.439678e-04 1.000095e-04 4.490836e-04 1.439356e-04 3.013250e-04
    ## 18 1.199637e-04 4.247160e-05 4.751249e-04 1.033641e-04 1.808046e-04
    ## 19 1.326971e-04 5.653632e-06 6.426187e-05 3.523267e-05 2.291717e-05
    ## 20 2.522402e-05 2.590718e-05 1.255548e-04 6.208052e-05 1.534168e-04
    ## 21 8.777913e-05 2.543732e-05 2.812706e-04 1.020361e-04 1.801940e-04
    ##    Sector_Money Sector_NoDur Sector_Other Sector_Shops Sector_Telcm
    ## 2  2.540734e-04 2.518141e-04 1.330065e-04 1.657130e-04 1.523227e-04
    ## 3  8.551913e-05 1.324980e-04 2.245867e-04 3.780825e-04 1.935840e-04
    ## 4  1.619122e-04 3.318144e-04 1.640147e-04 2.196159e-04 1.000396e-04
    ## 5  1.526591e-04 5.515453e-04 2.172036e-04 1.589323e-04 4.809520e-05
    ## 6  2.619517e-04 6.650601e-04 1.475991e-04 5.344154e-03 4.427864e-04
    ## 7  1.004663e-04 5.217385e-04 3.020534e-04 2.180354e-03 7.584431e-04
    ## 8  1.114016e-04 3.946970e-04 9.429347e-04 1.896652e-03 6.489301e-04
    ## 9  2.102061e-04 6.157033e-04 9.408185e-04 3.615951e-03 5.322839e-04
    ## 10 1.273002e-04 7.101430e-04 1.448978e-03 2.123029e-03 5.083171e-04
    ## 11 1.652232e-04 5.832500e-05 1.121273e-03 6.836482e-05 2.424960e-04
    ## 12 9.205595e-05 1.529563e-04 1.239172e-03 1.488393e-04 1.874265e-04
    ## 13 1.403651e-04 1.505823e-04 1.398903e-03 2.680614e-04 1.948462e-04
    ## 14 1.179640e-04 1.792974e-04 1.430472e-03 4.245298e-04 2.332008e-04
    ## 15 7.063110e-05 9.685482e-05 1.097805e-03 2.824740e-04 1.279847e-04
    ## 16 1.223670e-04 1.417859e-04 1.917197e-03 2.853897e-04 3.381498e-04
    ## 17 4.586744e-05 5.466814e-05 1.760626e-03 1.626909e-04 2.288680e-04
    ## 18 6.688268e-05 6.369678e-05 9.557928e-04 1.167540e-04 8.410336e-05
    ## 19 2.810456e-05 9.915985e-06 2.052287e-04 3.939889e-05 9.631188e-05
    ## 20 1.669146e-05 6.136711e-05 3.556679e-05 1.476067e-04 9.004443e-05
    ## 21 4.063354e-04 1.424086e-04 1.504443e-04 1.542339e-04 9.617615e-05
    ##    Sector_Utils Current.Ratio Long.term.Debt...Capital Debt.Equity.Ratio
    ## 2  5.192122e-04  0.0051529090             0.0009167555       0.011691998
    ## 3  3.206723e-04  0.0025041223             0.0032812797       0.007869666
    ## 4  6.933333e-04  0.0048680343             0.0011589588       0.015204760
    ## 5  8.336828e-04  0.0048791367             0.0011355140       0.007325035
    ## 6  1.002049e-03  0.0177348750             0.0024282533       0.009721032
    ## 7  1.553135e-03  0.0314007188             0.0039642250       0.008409079
    ## 8  1.254699e-03  0.0302577924             0.0026307392       0.008214974
    ## 9  1.217577e-03  0.0256728237             0.0023803470       0.007257794
    ## 10 1.137364e-03  0.0300055585             0.0024570184       0.007110212
    ## 11 2.721635e-04  0.0220216321             0.0010173721       0.007828488
    ## 12 2.005832e-04  0.0214017832             0.0029755493       0.008072046
    ## 13 2.705895e-04  0.0243235088             0.0021889176       0.007454697
    ## 14 2.833134e-04  0.0258641361             0.0027925403       0.008590158
    ## 15 1.017864e-04  0.0178098717             0.0044313491       0.007469952
    ## 16 4.499354e-04  0.0302125203             0.0008511459       0.009013094
    ## 17 2.349729e-04  0.0239882277             0.0003726805       0.012396705
    ## 18 1.246818e-04  0.0205392807             0.0005857516       0.007784791
    ## 19 8.491233e-05  0.0005334227             0.0001299844       0.020108821
    ## 20 1.049766e-04  0.0006787873             0.0001150844       0.013119232
    ## 21 5.796897e-05  0.0003809424             0.0004836861       0.007309731
    ##    Gross.Margin Net.Profit.Margin Asset.Turnover ROE...Return.On.Equity
    ## 2   0.006158187       0.013195765   0.0019958926            0.001823505
    ## 3   0.005834708       0.011863155   0.0018829531            0.001231959
    ## 4   0.005625378       0.009822033   0.0016113913            0.001625614
    ## 5   0.005564854       0.008509447   0.0016668412            0.001193814
    ## 6   0.005348683       0.007148896   0.0257834419            0.001275056
    ## 7   0.005298841       0.006563179   0.0122707367            0.001317840
    ## 8   0.005345211       0.006724523   0.0129363962            0.001428521
    ## 9   0.005255165       0.006038018   0.0173958957            0.001133212
    ## 10  0.005360888       0.005514980   0.0148434380            0.001160134
    ## 11  0.005521290       0.007397680   0.0021011293            0.001350334
    ## 12  0.005554181       0.006998273   0.0016340468            0.001223851
    ## 13  0.005491184       0.007904930   0.0025028533            0.001257754
    ## 14  0.005430983       0.007385618   0.0031379594            0.001362161
    ## 15  0.005613510       0.005247121   0.0019905056            0.001313508
    ## 16  0.005595627       0.006043690   0.0026708650            0.001335703
    ## 17  0.006029470       0.005336364   0.0009536283            0.001487734
    ## 18  0.006969151       0.013635984   0.0006921295            0.001352404
    ## 19  0.006827154       0.008052665   0.0003075684            0.001402771
    ## 20  0.007114632       0.018248747   0.0007223760            0.001255489
    ## 21  0.007869898       0.013814422   0.0006650956            0.001242745
    ##    Return.On.Tangible.Equity ROA...Return.On.Assets ROI...Return.On.Investment
    ## 2               2.843666e-04            0.027273513                 0.01619372
    ## 3               3.887045e-04            0.021258306                 0.01126709
    ## 4               9.510892e-05            0.029948617                 0.01701045
    ## 5               2.138781e-04            0.026844453                 0.01497007
    ## 6               1.264012e-04            0.023965000                 0.01299084
    ## 7               2.593751e-04            0.018359729                 0.01068224
    ## 8               1.184844e-04            0.027267583                 0.01572630
    ## 9               1.876378e-04            0.021733224                 0.01282982
    ## 10              1.854500e-04            0.022208497                 0.01290128
    ## 11              2.548649e-04            0.028880130                 0.01836507
    ## 12              2.211240e-04            0.020666420                 0.01020700
    ## 13              2.509828e-04            0.024740677                 0.01387849
    ## 14              2.668458e-04            0.023711428                 0.01282188
    ## 15              2.493518e-04            0.017130037                 0.01076861
    ## 16              3.527102e-04            0.032405655                 0.01934512
    ## 17              5.052115e-04            0.015039136                 0.01393022
    ## 18              3.018862e-04            0.008078502                 0.01303292
    ## 19              3.243402e-04            0.007591289                 0.01267349
    ## 20              9.347502e-04            0.008707551                 0.01703768
    ## 21              3.794086e-04            0.034327478                 0.01417786
    ##    Operating.Cash.Flow.Per.Share Free.Cash.Flow.Per.Share
    ## 2                    0.014072446              0.013306607
    ## 3                    0.034952144              0.017492187
    ## 4                    0.012989275              0.008618871
    ## 5                    0.010464141              0.009558334
    ## 6                    0.016788679              0.011290408
    ## 7                    0.017379514              0.009276892
    ## 8                    0.014644976              0.011794636
    ## 9                    0.008930682              0.006739888
    ## 10                   0.010236747              0.008445530
    ## 11                   0.018859280              0.015783442
    ## 12                   0.014073031              0.009574027
    ## 13                   0.016285484              0.008252723
    ## 14                   0.018316464              0.016010590
    ## 15                   0.015681523              0.016560738
    ## 16                   0.011201681              0.008723711
    ## 17                   0.021690454              0.012646027
    ## 18                   0.025031224              0.020944789
    ## 19                   0.013322224              0.019134917
    ## 20                   0.021813470              0.011679048
    ## 21                   0.014225151              0.011185256
    ## 
    ## Residual Deviance: 29226.84 
    ## AIC: 30386.84

## Model Validation

``` r
# Predict the samples from test data using the model
result <- predict(multinom.model, test)

# Print the Confusion matrix
confusionMatrix(as.factor(result), as.factor(test$Rating))
```

    ## Confusion Matrix and Statistics
    ## 
    ##           Reference
    ## Prediction   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
    ##         1    0   0   0   0   0   0   0   3   0   1   0   0   4   1   1   0   0
    ##         2    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    ##         3    0   0   0   0   0   1   0   0   0   1   1   0   0   0   0   0   0
    ##         4    0   0   0   0   0   0   2   0   0   0   1   1   0   0   2   0   0
    ##         5    0   5   4   3   6   5   6   6   3   4   6   1   2   0   0   1   0
    ##         6    6   2   6   8   9  35  19  26  15  24   4   1   0   2   2   2   1
    ##         7    0   4   9  28  46  47  47  36  15  16   4   2   0   0   0   1   0
    ##         8    0   0   1   1   5   1  10  15  14   7   0   0   0   0   0   0   0
    ##         9   10   6  11   8  28  82  47  90 117  82   0   0   0   0   0   0   0
    ##         10   0   0   0   0   0   2   1   0   2   3   0   0   1   2   1   0   0
    ##         11   0   0   0   0   1   0   0   0   0   0  37  30  12  27  16   9   7
    ##         12   0   0   0   0   0   0   0   0   0   0  17  15  19  20  13  13   3
    ##         13   0   0   0   0   3   0   0   1   1   0  24  23  23  18   9   7   6
    ##         14   0   0   0   0   1   0   0   0   0   0   8   9  11  15  10  13   4
    ##         15   0   0   0   0   0   1   1   1   1   3   2   2   3   5   6   8   3
    ##         16   0   0   0   0   0   0   0   0   0   0   5   0   2   1   1   2   1
    ##         17   0   0   0   0   0   0   0   0   0   1   1   0   1   0   1   0   0
    ##         18   0   0   0   0   0   1   0   1   0   0   0   0   0   0   1   0   2
    ##         19   0   0   0   0   0   0   0   0   1   0   0   1   1   1   2   2   2
    ##         20   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0
    ##         21   0   0   0   0   0   0   0   0   1   0   1   0   0   0   0   0   0
    ##           Reference
    ## Prediction  18  19  20  21
    ##         1    0   0   0   0
    ##         2    0   0   0   0
    ##         3    0   0   0   0
    ##         4    0   0   0   0
    ##         5    0   0   0   0
    ##         6    0   0   0   0
    ##         7    0   0   0   0
    ##         8    0   0   0   0
    ##         9    0   1   0   0
    ##         10   2   0   0   0
    ##         11   4   0   0   2
    ##         12   2   0   1   0
    ##         13   0   0   0   0
    ##         14   0   0   0   0
    ##         15   1   0   2   0
    ##         16   0   0   0   0
    ##         17   1   0   0   0
    ##         18   1   0   0   0
    ##         19   0   0   0   0
    ##         20   0   0   0   0
    ##         21   0   0   0   0
    ## 
    ## Overall Statistics
    ##                                           
    ##                Accuracy : 0.2081          
    ##                  95% CI : (0.1882, 0.2292)
    ##     No Information Rate : 0.1157          
    ##     P-Value [Acc > NIR] : < 2.2e-16       
    ##                                           
    ##                   Kappa : 0.1338          
    ##                                           
    ##  Mcnemar's Test P-Value : NA              
    ## 
    ## Statistics by Class:
    ## 
    ##                      Class: 1 Class: 2 Class: 3 Class: 4 Class: 5 Class: 6
    ## Sensitivity          0.000000  0.00000 0.000000 0.000000 0.060606  0.20000
    ## Specificity          0.993468  1.00000 0.998021 0.995997 0.968232  0.90743
    ## Pos Pred Value       0.000000      NaN 0.000000 0.000000 0.115385  0.21605
    ## Neg Pred Value       0.989590  0.98901 0.979922 0.968851 0.937793  0.89892
    ## Prevalence           0.010343  0.01099 0.020039 0.031028 0.063995  0.11312
    ## Detection Rate       0.000000  0.00000 0.000000 0.000000 0.003878  0.02262
    ## Detection Prevalence 0.006464  0.00000 0.001939 0.003878 0.033613  0.10472
    ## Balanced Accuracy    0.496734  0.50000 0.499011 0.497999 0.514419  0.55372
    ##                      Class: 7 Class: 8 Class: 9 Class: 10 Class: 11 Class: 12
    ## Sensitivity           0.35338 0.083799  0.68824  0.020979   0.33333  0.176471
    ## Specificity           0.85290 0.971491  0.73493  0.992165   0.92479  0.939808
    ## Pos Pred Value        0.18431 0.277778  0.24274  0.214286   0.25517  0.145631
    ## Neg Pred Value        0.93344 0.890154  0.95023  0.908676   0.94722  0.951524
    ## Prevalence            0.08597 0.115708  0.10989  0.092437   0.07175  0.054945
    ## Detection Rate        0.03038 0.009696  0.07563  0.001939   0.02392  0.009696
    ## Detection Prevalence  0.16484 0.034906  0.31157  0.009050   0.09373  0.066580
    ## Balanced Accuracy     0.60314 0.527645  0.71158  0.506572   0.62906  0.558140
    ##                      Class: 13 Class: 14 Class: 15 Class: 16 Class: 17
    ## Sensitivity            0.29114  0.163043  0.092308  0.034483  0.000000
    ## Specificity            0.93733  0.961512  0.977733  0.993284  0.996706
    ## Pos Pred Value         0.20000  0.211268  0.153846  0.166667  0.000000
    ## Neg Pred Value         0.96089  0.947832  0.960875  0.963518  0.981193
    ## Prevalence             0.05107  0.059470  0.042017  0.037492  0.018746
    ## Detection Rate         0.01487  0.009696  0.003878  0.001293  0.000000
    ## Detection Prevalence   0.07434  0.045895  0.025210  0.007757  0.003232
    ## Balanced Accuracy      0.61423  0.562278  0.535020  0.513883  0.498353
    ##                      Class: 18 Class: 19 Class: 20 Class: 21
    ## Sensitivity          0.0909091 0.0000000 0.0000000  0.000000
    ## Specificity          0.9967448 0.9935317 0.9993523  0.998706
    ## Pos Pred Value       0.1666667 0.0000000 0.0000000  0.000000
    ## Neg Pred Value       0.9935107 0.9993494 0.9980595  0.998706
    ## Prevalence           0.0071105 0.0006464 0.0019392  0.001293
    ## Detection Rate       0.0006464 0.0000000 0.0000000  0.000000
    ## Detection Prevalence 0.0038785 0.0064641 0.0006464  0.001293
    ## Balanced Accuracy    0.5438269 0.4967658 0.4996762  0.499353

The model has a very low accuracy and is not better than random guesses.
