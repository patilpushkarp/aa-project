# Naive Bayes

``` r
# Load libraries
library(e1071)
library(caret)
```

    ## Loading required package: ggplot2

    ## Loading required package: lattice

## Import Data

``` r
# Read training and testing data
train <- read.csv("./../data/classification_data/intermediates/train.csv")
test <- read.csv("./../data/classification_data/intermediates/test.csv")
```

## Model Training

``` r
nb.model <- naiveBayes(Rating~., data=train)
nb.model
```

    ## 
    ## Naive Bayes Classifier for Discrete Predictors
    ## 
    ## Call:
    ## naiveBayes.default(x = X, y = Y, laplace = laplace)
    ## 
    ## A-priori probabilities:
    ## Y
    ##           1           2           3           4           5           6 
    ## 0.011616651 0.008551146 0.024846725 0.031784447 0.060987415 0.104711197 
    ##           7           8           9          10          11          12 
    ## 0.093094547 0.106485963 0.118909326 0.090190384 0.069861246 0.059373992 
    ##          13          14          15          16          17          18 
    ## 0.056147144 0.053242982 0.039528880 0.037108745 0.019522427 0.008712488 
    ##          19          20          21 
    ## 0.001452081 0.002420136 0.001452081 
    ## 
    ## Conditional probabilities:
    ##     X.1
    ## Y        [,1]     [,2]
    ##   1  3737.208 2610.478
    ##   2  4057.245 1690.011
    ##   3  4185.422 2266.868
    ##   4  3955.817 1756.509
    ##   5  4027.291 1796.398
    ##   6  3909.958 2233.826
    ##   7  3836.385 2043.567
    ##   8  3712.311 2232.681
    ##   9  3714.558 2279.451
    ##   10 3895.893 2377.237
    ##   11 4276.088 2194.629
    ##   12 4060.299 2335.446
    ##   13 3826.511 2429.424
    ##   14 3909.158 2349.937
    ##   15 3612.090 2379.173
    ##   16 3831.991 2322.806
    ##   17 4226.190 2394.688
    ##   18 2847.352 2141.736
    ##   19 2988.889 2735.280
    ##   20 3758.667 3054.923
    ##   21 2754.667 2488.700
    ## 
    ##     X
    ## Y        [,1]     [,2]
    ##   1  3737.208 2610.478
    ##   2  4057.245 1690.011
    ##   3  4185.422 2266.868
    ##   4  3955.817 1756.509
    ##   5  4027.291 1796.398
    ##   6  3909.958 2233.826
    ##   7  3836.385 2043.567
    ##   8  3712.311 2232.681
    ##   9  3714.558 2279.451
    ##   10 3895.893 2377.237
    ##   11 4276.088 2194.629
    ##   12 4060.299 2335.446
    ##   13 3826.511 2429.424
    ##   14 3909.158 2349.937
    ##   15 3612.090 2379.173
    ##   16 3831.991 2322.806
    ##   17 4226.190 2394.688
    ##   18 2847.352 2141.736
    ##   19 2988.889 2735.280
    ##   20 3758.667 3054.923
    ##   21 2754.667 2488.700
    ## 
    ##     Rating.Agency_Egan.Jones.Ratings.Company
    ## Y          [,1]      [,2]
    ##   1  0.02777778 0.1654888
    ##   2  0.64150943 0.4841463
    ##   3  0.40259740 0.4920210
    ##   4  0.71065990 0.4546114
    ##   5  0.71164021 0.4535998
    ##   6  0.41140216 0.4924674
    ##   7  0.54939341 0.4979860
    ##   8  0.34545455 0.4758769
    ##   9  0.33107191 0.4709185
    ##   10 0.26296959 0.4406404
    ##   11 0.41108545 0.4925998
    ##   12 0.24456522 0.4304143
    ##   13 0.16954023 0.3757687
    ##   14 0.20303030 0.4028658
    ##   15 0.19591837 0.3977185
    ##   16 0.20000000 0.4008724
    ##   17 0.13223140 0.3401507
    ##   18 0.20370370 0.4065330
    ##   19 0.11111111 0.3333333
    ##   20 0.13333333 0.3518658
    ##   21 0.44444444 0.5270463
    ## 
    ##     Rating.Agency_Fitch.Ratings
    ## Y          [,1]      [,2]
    ##   1  0.00000000 0.0000000
    ##   2  0.01886792 0.1373606
    ##   3  0.01298701 0.1135875
    ##   4  0.03045685 0.1722785
    ##   5  0.02645503 0.1606968
    ##   6  0.06163328 0.2406738
    ##   7  0.04679376 0.2113801
    ##   8  0.10303030 0.3042290
    ##   9  0.06648575 0.2492985
    ##   10 0.11806798 0.3229776
    ##   11 0.05773672 0.2335147
    ##   12 0.06250000 0.2423910
    ##   13 0.04310345 0.2033824
    ##   14 0.02121212 0.1443096
    ##   15 0.03673469 0.1884948
    ##   16 0.05652174 0.2314301
    ##   17 0.04958678 0.2179923
    ##   18 0.16666667 0.3761774
    ##   19 0.00000000 0.0000000
    ##   20 0.13333333 0.3518658
    ##   21 0.11111111 0.3333333
    ## 
    ##     Rating.Agency_Moody.s.Investors.Service
    ## Y          [,1]      [,2]
    ##   1  0.09722222 0.2983392
    ##   2  0.18867925 0.3949977
    ##   3  0.07142857 0.2583796
    ##   4  0.06598985 0.2488969
    ##   5  0.13756614 0.3449006
    ##   6  0.09553159 0.2941745
    ##   7  0.16984402 0.3758215
    ##   8  0.25757576 0.4376307
    ##   9  0.21709634 0.4125487
    ##   10 0.22719141 0.4193926
    ##   11 0.16397229 0.3706787
    ##   12 0.26630435 0.4426271
    ##   13 0.29597701 0.4571380
    ##   14 0.32727273 0.4699303
    ##   15 0.30204082 0.4600828
    ##   16 0.36956522 0.4837398
    ##   17 0.39669421 0.4912457
    ##   18 0.27777778 0.4521090
    ##   19 0.66666667 0.5000000
    ##   20 0.46666667 0.5163978
    ##   21 0.00000000 0.0000000
    ## 
    ##     Rating.Agency_Standard...Poor.s.Ratings.Services
    ## Y         [,1]      [,2]
    ##   1  0.8750000 0.3330398
    ##   2  0.1509434 0.3614196
    ##   3  0.5129870 0.5014621
    ##   4  0.1928934 0.3955753
    ##   5  0.1243386 0.3304048
    ##   6  0.4314330 0.4956583
    ##   7  0.2339688 0.4237199
    ##   8  0.2939394 0.4559100
    ##   9  0.3853460 0.4870075
    ##   10 0.3917710 0.4885832
    ##   11 0.3672055 0.4826008
    ##   12 0.4266304 0.4952610
    ##   13 0.4913793 0.5006455
    ##   14 0.4484848 0.4980944
    ##   15 0.4653061 0.4998160
    ##   16 0.3739130 0.4848962
    ##   17 0.4214876 0.4958506
    ##   18 0.3518519 0.4820322
    ##   19 0.2222222 0.4409586
    ##   20 0.2666667 0.4577377
    ##   21 0.4444444 0.5270463
    ## 
    ##     Binary.Rating
    ## Y    [,1] [,2]
    ##   1     1    0
    ##   2     1    0
    ##   3     1    0
    ##   4     1    0
    ##   5     1    0
    ##   6     1    0
    ##   7     1    0
    ##   8     1    0
    ##   9     1    0
    ##   10    1    0
    ##   11    0    0
    ##   12    0    0
    ##   13    0    0
    ##   14    0    0
    ##   15    0    0
    ##   16    0    0
    ##   17    0    0
    ##   18    0    0
    ##   19    0    0
    ##   20    0    0
    ##   21    0    0
    ## 
    ##     Sector_BusEq
    ## Y          [,1]      [,2]
    ##   1  0.29166667 0.4577194
    ##   2  0.24528302 0.4343722
    ##   3  0.22727273 0.4204375
    ##   4  0.15228426 0.3602116
    ##   5  0.13227513 0.3392387
    ##   6  0.10477658 0.3065015
    ##   7  0.10398614 0.3055074
    ##   8  0.08030303 0.2719679
    ##   9  0.13839891 0.3455527
    ##   10 0.17889088 0.3836042
    ##   11 0.13856813 0.3458949
    ##   12 0.16032609 0.3674077
    ##   13 0.11781609 0.3228544
    ##   14 0.09090909 0.2879164
    ##   15 0.10612245 0.3086248
    ##   16 0.07826087 0.2691674
    ##   17 0.04958678 0.2179923
    ##   18 0.11111111 0.3172206
    ##   19 0.00000000 0.0000000
    ##   20 0.06666667 0.2581989
    ##   21 0.11111111 0.3333333
    ## 
    ##     Sector_Chems
    ## Y           [,1]       [,2]
    ##   1  0.000000000 0.00000000
    ##   2  0.000000000 0.00000000
    ##   3  0.019480519 0.13865739
    ##   4  0.000000000 0.00000000
    ##   5  0.060846561 0.23936548
    ##   6  0.052388290 0.22298064
    ##   7  0.010398614 0.10153003
    ##   8  0.031818182 0.17564889
    ##   9  0.080054274 0.27156150
    ##   10 0.059033989 0.23589940
    ##   11 0.030023095 0.17084824
    ##   12 0.013586957 0.11592614
    ##   13 0.037356322 0.18990645
    ##   14 0.090909091 0.28791636
    ##   15 0.012244898 0.11020222
    ##   16 0.030434783 0.17215506
    ##   17 0.008264463 0.09090909
    ##   18 0.018518519 0.13608276
    ##   19 0.000000000 0.00000000
    ##   20 0.000000000 0.00000000
    ##   21 0.000000000 0.00000000
    ## 
    ##     Sector_Durbl
    ## Y          [,1]      [,2]
    ##   1  0.00000000 0.0000000
    ##   2  0.00000000 0.0000000
    ##   3  0.00000000 0.0000000
    ##   4  0.03553299 0.1855943
    ##   5  0.05026455 0.2187799
    ##   6  0.02003082 0.1402137
    ##   7  0.01213172 0.1095689
    ##   8  0.02575758 0.1585314
    ##   9  0.01492537 0.1213367
    ##   10 0.02862254 0.1668925
    ##   11 0.02309469 0.1503780
    ##   12 0.05163043 0.2215810
    ##   13 0.02011494 0.1405956
    ##   14 0.02424242 0.1540345
    ##   15 0.10612245 0.3086248
    ##   16 0.04347826 0.2043759
    ##   17 0.00000000 0.0000000
    ##   18 0.01851852 0.1360828
    ##   19 0.00000000 0.0000000
    ##   20 0.00000000 0.0000000
    ##   21 0.00000000 0.0000000
    ## 
    ##     Sector_Enrgy
    ## Y          [,1]      [,2]
    ##   1  0.23611111 0.4276716
    ##   2  0.43396226 0.5003627
    ##   3  0.09090909 0.2884177
    ##   4  0.02538071 0.1576792
    ##   5  0.05026455 0.2187799
    ##   6  0.09090909 0.2877015
    ##   7  0.06412478 0.2451877
    ##   8  0.11515152 0.3194468
    ##   9  0.07055631 0.2562562
    ##   10 0.03935599 0.1946146
    ##   11 0.07390300 0.2619156
    ##   12 0.07065217 0.2565918
    ##   13 0.03735632 0.1899065
    ##   14 0.07575758 0.2650117
    ##   15 0.16734694 0.3740495
    ##   16 0.13913043 0.3468374
    ##   17 0.18181818 0.3872983
    ##   18 0.01851852 0.1360828
    ##   19 0.33333333 0.5000000
    ##   20 0.20000000 0.4140393
    ##   21 0.11111111 0.3333333
    ## 
    ##     Sector_Hlth
    ## Y          [,1]      [,2]
    ##   1  0.34722222 0.4794281
    ##   2  0.15094340 0.3614196
    ##   3  0.13636364 0.3442940
    ##   4  0.22842640 0.4208883
    ##   5  0.16137566 0.3683647
    ##   6  0.07087827 0.2568193
    ##   7  0.08665511 0.2815731
    ##   8  0.07424242 0.2623638
    ##   9  0.03392130 0.1811496
    ##   10 0.03756708 0.1903171
    ##   11 0.06004619 0.2378472
    ##   12 0.04076087 0.1980049
    ##   13 0.04310345 0.2033824
    ##   14 0.08181818 0.2745037
    ##   15 0.05714286 0.2325905
    ##   16 0.10869565 0.3119358
    ##   17 0.20661157 0.4065578
    ##   18 0.05555556 0.2312123
    ##   19 0.00000000 0.0000000
    ##   20 0.00000000 0.0000000
    ##   21 0.00000000 0.0000000
    ## 
    ##     Sector_Manuf
    ## Y          [,1]      [,2]
    ##   1  0.02777778 0.1654888
    ##   2  0.00000000 0.0000000
    ##   3  0.23376623 0.4246061
    ##   4  0.08121827 0.2738660
    ##   5  0.14021164 0.3476667
    ##   6  0.11710324 0.3217913
    ##   7  0.10398614 0.3055074
    ##   8  0.10909091 0.3119897
    ##   9  0.12890095 0.3353178
    ##   10 0.13595707 0.3430499
    ##   11 0.18706697 0.3904164
    ##   12 0.16032609 0.3674077
    ##   13 0.17528736 0.3807602
    ##   14 0.10909091 0.3122267
    ##   15 0.08571429 0.2805147
    ##   16 0.06521739 0.2474476
    ##   17 0.14876033 0.3573317
    ##   18 0.05555556 0.2312123
    ##   19 0.00000000 0.0000000
    ##   20 0.00000000 0.0000000
    ##   21 0.00000000 0.0000000
    ## 
    ##     Sector_Money
    ## Y           [,1]       [,2]
    ##   1  0.000000000 0.00000000
    ##   2  0.000000000 0.00000000
    ##   3  0.000000000 0.00000000
    ##   4  0.000000000 0.00000000
    ##   5  0.023809524 0.15265740
    ##   6  0.021571649 0.14539217
    ##   7  0.036395147 0.18743379
    ##   8  0.009090909 0.09498386
    ##   9  0.023066486 0.15021664
    ##   10 0.042933810 0.20288947
    ##   11 0.020785219 0.14282965
    ##   12 0.035326087 0.18485402
    ##   13 0.028735632 0.16730310
    ##   14 0.039393939 0.19482576
    ##   15 0.048979592 0.21626719
    ##   16 0.060869565 0.23961237
    ##   17 0.000000000 0.00000000
    ##   18 0.000000000 0.00000000
    ##   19 0.000000000 0.00000000
    ##   20 0.000000000 0.00000000
    ##   21 0.000000000 0.00000000
    ## 
    ##     Sector_NoDur
    ## Y           [,1]       [,2]
    ##   1  0.000000000 0.00000000
    ##   2  0.000000000 0.00000000
    ##   3  0.045454545 0.20897850
    ##   4  0.045685279 0.20933364
    ##   5  0.105820106 0.30801493
    ##   6  0.120184900 0.32542844
    ##   7  0.103986135 0.30550741
    ##   8  0.048484848 0.21495133
    ##   9  0.093622795 0.29150105
    ##   10 0.101967800 0.30287699
    ##   11 0.073903002 0.26191559
    ##   12 0.057065217 0.23228301
    ##   13 0.040229885 0.19678088
    ##   14 0.036363636 0.18747755
    ##   15 0.032653061 0.17809069
    ##   16 0.043478261 0.20437590
    ##   17 0.008264463 0.09090909
    ##   18 0.000000000 0.00000000
    ##   19 0.000000000 0.00000000
    ##   20 0.000000000 0.00000000
    ##   21 0.000000000 0.00000000
    ## 
    ##     Sector_Other
    ## Y          [,1]      [,2]
    ##   1  0.02777778 0.1654888
    ##   2  0.11320755 0.3198784
    ##   3  0.11688312 0.3223292
    ##   4  0.14720812 0.3552160
    ##   5  0.05555556 0.2293650
    ##   6  0.12326656 0.3289965
    ##   7  0.10398614 0.3055074
    ##   8  0.18030303 0.3847312
    ##   9  0.14925373 0.3565804
    ##   10 0.13237925 0.3392062
    ##   11 0.16859122 0.3748235
    ##   12 0.20652174 0.4053604
    ##   13 0.29022989 0.4545219
    ##   14 0.20909091 0.4072770
    ##   15 0.19591837 0.3977185
    ##   16 0.18260870 0.3871880
    ##   17 0.19008264 0.3939977
    ##   18 0.53703704 0.5033084
    ##   19 0.33333333 0.5000000
    ##   20 0.33333333 0.4879500
    ##   21 0.66666667 0.5000000
    ## 
    ##     Sector_Shops
    ## Y          [,1]      [,2]
    ##   1  0.00000000 0.0000000
    ##   2  0.05660377 0.2332953
    ##   3  0.09740260 0.2974726
    ##   4  0.09137056 0.2888695
    ##   5  0.10052910 0.3011027
    ##   6  0.10939908 0.3123800
    ##   7  0.10225303 0.3032437
    ##   8  0.09393939 0.2919657
    ##   9  0.09769335 0.2971012
    ##   10 0.10196780 0.3028770
    ##   11 0.05080831 0.2198601
    ##   12 0.07880435 0.2698000
    ##   13 0.13505747 0.3422771
    ##   14 0.16666667 0.3732439
    ##   15 0.10612245 0.3086248
    ##   16 0.13043478 0.3375157
    ##   17 0.09917355 0.3001377
    ##   18 0.01851852 0.1360828
    ##   19 0.33333333 0.5000000
    ##   20 0.00000000 0.0000000
    ##   21 0.00000000 0.0000000
    ## 
    ##     Sector_Telcm
    ## Y          [,1]      [,2]
    ##   1  0.00000000 0.0000000
    ##   2  0.00000000 0.0000000
    ##   3  0.00000000 0.0000000
    ##   4  0.00000000 0.0000000
    ##   5  0.00000000 0.0000000
    ##   6  0.03081664 0.1729539
    ##   7  0.03812825 0.1916720
    ##   8  0.04242424 0.2017079
    ##   9  0.03663501 0.1879916
    ##   10 0.07513417 0.2638438
    ##   11 0.08545035 0.2798741
    ##   12 0.07608696 0.2654982
    ##   13 0.05747126 0.2330760
    ##   14 0.05454545 0.2274357
    ##   15 0.07755102 0.2680113
    ##   16 0.04782609 0.2138635
    ##   17 0.09917355 0.3001377
    ##   18 0.14814815 0.3585825
    ##   19 0.00000000 0.0000000
    ##   20 0.33333333 0.4879500
    ##   21 0.00000000 0.0000000
    ## 
    ##     Sector_Utils
    ## Y           [,1]       [,2]
    ##   1  0.069444444 0.25599235
    ##   2  0.000000000 0.00000000
    ##   3  0.032467532 0.17781650
    ##   4  0.192893401 0.39557534
    ##   5  0.119047619 0.32427375
    ##   6  0.138674884 0.34587351
    ##   7  0.233968804 0.42371991
    ##   8  0.189393939 0.39211840
    ##   9  0.132971506 0.33977453
    ##   10 0.066189624 0.24883594
    ##   11 0.087759815 0.28327257
    ##   12 0.048913043 0.21597990
    ##   13 0.017241379 0.13035699
    ##   14 0.021212121 0.14430965
    ##   15 0.004081633 0.06388766
    ##   16 0.069565217 0.25496773
    ##   17 0.008264463 0.09090909
    ##   18 0.018518519 0.13608276
    ##   19 0.000000000 0.00000000
    ##   20 0.066666667 0.25819889
    ##   21 0.111111111 0.33333333
    ## 
    ##     Current.Ratio
    ## Y        [,1]      [,2]
    ##   1  1.746429 0.6683307
    ##   2  1.488317 0.6195379
    ##   3  1.884905 0.9634159
    ##   4  1.816031 0.9560198
    ##   5  1.818763 0.9422079
    ##   6  1.565427 1.0144630
    ##   7  1.625881 1.6040345
    ##   8  1.623172 1.2466949
    ##   9  1.747711 1.0257157
    ##   10 1.845560 1.1516055
    ##   11 2.079715 1.8006728
    ##   12 2.245915 2.0599961
    ##   13 2.240668 1.6682000
    ##   14 2.157033 1.7904471
    ##   15 2.569992 3.4961224
    ##   16 2.255696 3.1072909
    ##   17 2.764921 3.7739195
    ##   18 6.121476 8.7557784
    ##   19 1.781722 1.0301771
    ##   20 3.098067 6.3192073
    ##   21 2.772633 2.8909938
    ## 
    ##     Long.term.Debt...Capital
    ## Y          [,1]      [,2]
    ##   1  0.15974722 0.1128156
    ##   2  0.16964340 0.1029031
    ##   3  0.30536623 0.1798107
    ##   4  0.31244467 0.1682266
    ##   5  0.35755873 0.2333727
    ##   6  0.39182696 0.1879115
    ##   7  0.40030260 0.1600729
    ##   8  0.45008045 0.3419179
    ##   9  0.41351303 0.1958826
    ##   10 0.43345814 0.2503000
    ##   11 0.45614411 0.2884337
    ##   12 0.50427935 0.2858947
    ##   13 0.51684454 0.2259016
    ##   14 0.56753606 0.3719354
    ##   15 0.80963061 1.2555141
    ##   16 0.09359652 8.2753527
    ##   17 0.71040000 0.5128744
    ##   18 0.75632778 0.5006648
    ##   19 0.88871111 0.6515336
    ##   20 1.47516000 2.5276194
    ##   21 0.50855556 0.8348959
    ## 
    ##     Debt.Equity.Ratio
    ## Y           [,1]        [,2]
    ##   1    0.2741778   0.1996474
    ##   2    0.2635302   0.1674270
    ##   3    3.1430357  22.0166421
    ##   4    0.6390071   0.5385738
    ##   5    2.2730590  12.8264039
    ##   6   -1.4569610  55.3956457
    ##   7    0.8446965   1.2347678
    ##   8    0.7307348   2.1664059
    ##   9    0.2779993  29.5676135
    ##   10   0.2832665  35.8115680
    ##   11   0.0143261  38.0729972
    ##   12   2.2860677   9.7441742
    ##   13  -1.9268517  47.0365403
    ##   14  -0.4388658  41.1449549
    ##   15  -3.0017429  46.0525579
    ##   16  -0.9183604  37.3742669
    ##   17   2.0835157  15.2319841
    ##   18 -25.1240815 200.8352667
    ##   19  -0.2687667   4.0736232
    ##   20  -0.2386133   3.2037506
    ##   21   1.6465778   2.9816281
    ## 
    ##     Gross.Margin
    ## Y        [,1]     [,2]
    ##   1  53.49638 19.73857
    ##   2  37.60814 17.95798
    ##   3  46.72747 20.65083
    ##   4  53.32118 23.13460
    ##   5  48.74435 22.59564
    ##   6  47.09488 22.65441
    ##   7  48.72250 23.54255
    ##   8  45.38993 24.23891
    ##   9  40.81806 22.03559
    ##   10 38.49140 22.34394
    ##   11 39.59788 22.90746
    ##   12 36.08656 23.06018
    ##   13 34.62037 20.53056
    ##   14 36.94168 24.69255
    ##   15 37.69367 26.69223
    ##   16 42.24883 27.77977
    ##   17 43.88398 23.34472
    ##   18 28.17424 19.03742
    ##   19 47.17367 24.58029
    ##   20 39.01415 26.91687
    ##   21 23.96760 12.33728
    ## 
    ##     Net.Profit.Margin
    ## Y          [,1]       [,2]
    ##   1   15.752501   7.761843
    ##   2   13.169819   6.932781
    ##   3   12.963369   7.846482
    ##   4   12.589235   9.146492
    ##   5   12.183031   7.850320
    ##   6   10.606692  10.979181
    ##   7   10.036816  17.687882
    ##   8    9.625932  10.826321
    ##   9    8.639969  10.042720
    ##   10   5.603782  15.721797
    ##   11   6.251879  21.467348
    ##   12   4.820338  13.212491
    ##   13   1.694212  26.087974
    ##   14  -1.570597  30.213399
    ##   15  -3.645731  40.225941
    ##   16  -9.802634  54.197405
    ##   17 -10.355634  44.095129
    ##   18  -8.256389  27.601517
    ##   19 -65.572356 136.542742
    ##   20 -33.288107 106.902169
    ##   21  -5.902678   6.359095
    ## 
    ##     Asset.Turnover
    ## Y         [,1]      [,2]
    ##   1  0.6916444 0.3596807
    ##   2  1.0022717 0.3551192
    ##   3  0.9589675 0.7677501
    ##   4  0.9015893 0.9354231
    ##   5  0.9679386 0.7943746
    ##   6  0.8809314 0.7975011
    ##   7  0.7931016 0.7777133
    ##   8  0.7811867 0.6025430
    ##   9  0.8217083 0.6400799
    ##   10 0.8620705 0.5967376
    ##   11 0.7232058 0.5024902
    ##   12 0.8760019 0.7096383
    ##   13 0.9028920 0.6032855
    ##   14 0.9316076 0.7299841
    ##   15 0.9347437 0.6469586
    ##   16 0.7311200 0.5703781
    ##   17 0.7282669 0.5609505
    ##   18 0.8133370 0.4991936
    ##   19 0.8070333 0.6359603
    ##   20 0.7630467 0.3881891
    ##   21 0.7463333 0.4932842
    ## 
    ##     ROE...Return.On.Equity
    ## Y            [,1]       [,2]
    ##   1    20.7758250   7.781054
    ##   2    22.7765226   9.024625
    ##   3    57.5779331 300.635724
    ##   4    17.5497609  12.228346
    ##   5    57.8692344 287.206222
    ##   6    -0.1818586 443.667667
    ##   7    17.5710560  25.407282
    ##   8    14.6162723  37.194450
    ##   9    28.3635090 264.458250
    ##   10   10.7635599 122.406107
    ##   11   15.7574596  67.391422
    ##   12   18.4184867  74.043498
    ##   13    0.2981325 271.377516
    ##   14    6.4724009  99.257730
    ##   15   10.4368143 258.872272
    ##   16  -23.0136604 171.020912
    ##   17   -7.9065992 436.046442
    ##   18 -139.5786315 787.995061
    ##   19  312.9313889 736.784232
    ##   20   49.2829667 159.474107
    ##   21   -1.6978222  15.905975
    ## 
    ##     Return.On.Tangible.Equity
    ## Y          [,1]       [,2]
    ##   1   55.318396   98.56162
    ##   2  408.865725 1894.42886
    ##   3   33.782850  172.05735
    ##   4   33.753211  174.70711
    ##   5   73.480625  729.29639
    ##   6   42.819767  577.06464
    ##   7    8.181985  125.05479
    ##   8   22.319915  403.78628
    ##   9   34.683761  207.80962
    ##   10   7.164035  682.91115
    ##   11   5.829354  153.19154
    ##   12  -0.726387  297.66531
    ##   13   2.269005  521.16253
    ##   14  -5.165543  149.27977
    ##   15 -15.276675  228.78790
    ##   16 -11.569143  187.50700
    ##   17   9.316481  135.97393
    ##   18  29.941493  193.93803
    ##   19   3.547689  307.38448
    ##   20  53.615953  158.90565
    ##   21   7.165267   17.57194
    ## 
    ##     ROA...Return.On.Assets
    ## Y          [,1]      [,2]
    ##   1    9.781697  4.585578
    ##   2   11.435557  4.060124
    ##   3    9.160594  4.360636
    ##   4    7.499383  4.783058
    ##   5    8.340303  4.584325
    ##   6    6.598922  5.188116
    ##   7    5.993037  5.560112
    ##   8    6.124927  5.091403
    ##   9    5.595371  4.854270
    ##   10   4.776924  6.232616
    ##   11   3.847386  6.920017
    ##   12   3.855674  7.976471
    ##   13   2.944536  9.898476
    ##   14   1.824302 10.093368
    ##   15  -1.418528 15.381344
    ##   16  -2.599183 16.959036
    ##   17  -2.937581 17.304941
    ##   18  -3.441750 13.487959
    ##   19 -21.018211 37.808668
    ##   20  -5.872087 24.529635
    ##   21  -3.372489  5.362486
    ## 
    ##     ROI...Return.On.Investment
    ## Y            [,1]       [,2]
    ##   1   17.61599861   7.106829
    ##   2   18.83283019   7.116373
    ##   3   14.69481104   7.292334
    ##   4   11.75444010   7.255420
    ##   5   13.92594815   8.761352
    ##   6   10.61851079   8.201315
    ##   7   10.07809081   8.389099
    ##   8   10.98801136  17.128353
    ##   9    8.70709905   7.881194
    ##   10   7.62604168  10.685858
    ##   11   5.25664365  11.332013
    ##   12   5.59522880  10.580155
    ##   13   4.45849856  13.554906
    ##   14   3.44039909  14.364325
    ##   15   0.07955878  24.757332
    ##   16 -12.46945043  81.564579
    ##   17  -4.73630000  26.252244
    ##   18  -4.79700000  19.567203
    ##   19 -31.93562222  49.401947
    ##   20 -41.17418000 118.036925
    ##   21   6.19077778  26.251954
    ## 
    ##     Operating.Cash.Flow.Per.Share
    ## Y           [,1]      [,2]
    ##   1   0.21678194  1.543644
    ##   2   0.70540943  1.610401
    ##   3   0.49275779  1.790729
    ##   4   0.55649746  1.504332
    ##   5   0.30558148  1.213159
    ##   6   0.44980092  3.287413
    ##   7   0.48287106  2.405790
    ##   8   0.51877212  2.304393
    ##   9   1.03312754 12.594000
    ##   10  0.57488909  5.518447
    ##   11  0.57935912  4.957730
    ##   12  0.72655652  5.262514
    ##   13  0.70494655  4.069063
    ##   14 -0.02404273  3.167312
    ##   15  0.96392408  7.710581
    ##   16  0.07673043  9.352505
    ##   17 -0.78253306 10.984003
    ##   18  1.98217778 11.929461
    ##   19 -0.67988889 35.886189
    ##   20 -9.60437333 25.922951
    ##   21  7.29733333 16.810032
    ## 
    ##     Free.Cash.Flow.Per.Share
    ## Y           [,1]      [,2]
    ##   1  -0.08347778  1.750847
    ##   2   0.09318113  1.932327
    ##   3   0.32092857  2.274948
    ##   4   0.38541523  1.842719
    ##   5   0.15651640  1.763112
    ##   6   0.11958521  5.783797
    ##   7   0.30292946  2.357331
    ##   8   0.12440606  2.642683
    ##   9   0.34959471 14.808858
    ##   10 -0.09018962  6.876826
    ##   11  0.38338476  3.170932
    ##   12  0.11893723  3.859250
    ##   13  0.30395259  3.199316
    ##   14 -0.26220303  3.231295
    ##   15 -0.27903429 15.944968
    ##   16 -1.04397652 12.358775
    ##   17  0.08682479  8.251743
    ##   18  1.43137778 11.251111
    ##   19 -1.07017778 27.395307
    ##   20 -7.62990667 22.707020
    ##   21  4.75024444 13.467172

``` r
result <- predict(nb.model, test)

confusionMatrix(as.factor(result), as.factor(test$Rating))
```

    ## Confusion Matrix and Statistics
    ## 
    ##           Reference
    ## Prediction  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21
    ##         1  13  1  7  5 21 50 38 56 55 37  2  1  4  1  0  1  0  0  0  0  0
    ##         2   3 16 19 31 47 65 51 48 53 36  0  1  0  0  0  0  0  0  0  0  0
    ##         3   0  0  2  0  0  1  3  1  1  3  0  0  0  0  0  0  0  0  0  0  0
    ##         4   0  0  1  5 14 11 12 13  7  5  0  0  0  1  0  0  0  0  0  0  0
    ##         5   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         6   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         7   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         8   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         9   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         10  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         11  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
    ##         13  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         14  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         15  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0
    ##         16  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    ##         17  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0
    ##         18  0  0  0  0  0  0  0  0  0  0  0  0  3  1  1  1  1  0  0  0  0
    ##         19  0  0  1  3  7 12 17 27 21 32 43 43 35 44 39 34 14  3  1  1  0
    ##         20  0  0  0  0  0  4  0  0  0  0  1  0  1  0  1  4  2  1  0  0  0
    ##         21  0  0  1  4 10 32 12 34 33 30 62 40 36 45 24 15 12  7  0  2  2
    ## 
    ## Overall Statistics
    ##                                          
    ##                Accuracy : 0.0252         
    ##                  95% CI : (0.018, 0.0343)
    ##     No Information Rate : 0.1157         
    ##     P-Value [Acc > NIR] : 1              
    ##                                          
    ##                   Kappa : 0.0186         
    ##                                          
    ##  Mcnemar's Test P-Value : NA             
    ## 
    ## Statistics by Class:
    ## 
    ##                      Class: 1 Class: 2 Class: 3 Class: 4 Class: 5 Class: 6
    ## Sensitivity          0.812500  0.94118 0.064516 0.104167  0.00000   0.0000
    ## Specificity          0.817766  0.76863 0.994063 0.957305  1.00000   1.0000
    ## Pos Pred Value       0.044521  0.04324 0.181818 0.072464      NaN      NaN
    ## Neg Pred Value       0.997610  0.99915 0.981120 0.970907  0.93601   0.8869
    ## Prevalence           0.010343  0.01099 0.020039 0.031028  0.06399   0.1131
    ## Detection Rate       0.008403  0.01034 0.001293 0.003232  0.00000   0.0000
    ## Detection Prevalence 0.188752  0.23917 0.007111 0.044602  0.00000   0.0000
    ## Balanced Accuracy    0.815133  0.85490 0.529290 0.530736  0.50000   0.5000
    ##                      Class: 7 Class: 8 Class: 9 Class: 10 Class: 11 Class: 12
    ## Sensitivity           0.00000   0.0000   0.0000   0.00000   0.00000 0.0000000
    ## Specificity           1.00000   1.0000   1.0000   1.00000   1.00000 0.9993160
    ## Pos Pred Value            NaN      NaN      NaN       NaN       NaN 0.0000000
    ## Neg Pred Value        0.91403   0.8843   0.8901   0.90756   0.92825 0.9450194
    ## Prevalence            0.08597   0.1157   0.1099   0.09244   0.07175 0.0549451
    ## Detection Rate        0.00000   0.0000   0.0000   0.00000   0.00000 0.0000000
    ## Detection Prevalence  0.00000   0.0000   0.0000   0.00000   0.00000 0.0006464
    ## Balanced Accuracy     0.50000   0.5000   0.5000   0.50000   0.50000 0.4996580
    ##                      Class: 13 Class: 14 Class: 15 Class: 16 Class: 17
    ## Sensitivity            0.00000   0.00000  0.000000   0.00000  0.000000
    ## Specificity            1.00000   1.00000  0.998650   1.00000  0.998024
    ## Pos Pred Value             NaN       NaN  0.000000       NaN  0.000000
    ## Neg Pred Value         0.94893   0.94053  0.957929   0.96251  0.981218
    ## Prevalence             0.05107   0.05947  0.042017   0.03749  0.018746
    ## Detection Rate         0.00000   0.00000  0.000000   0.00000  0.000000
    ## Detection Prevalence   0.00000   0.00000  0.001293   0.00000  0.001939
    ## Balanced Accuracy      0.50000   0.50000  0.499325   0.50000  0.499012
    ##                      Class: 18 Class: 19 Class: 20 Class: 21
    ## Sensitivity           0.000000 1.0000000  0.000000  1.000000
    ## Specificity           0.995443 0.7567917  0.990933  0.741748
    ## Pos Pred Value        0.000000 0.0026525  0.000000  0.004988
    ## Neg Pred Value        0.992857 1.0000000  0.998043  1.000000
    ## Prevalence            0.007111 0.0006464  0.001939  0.001293
    ## Detection Rate        0.000000 0.0006464  0.000000  0.001293
    ## Detection Prevalence  0.004525 0.2436975  0.009050  0.259211
    ## Balanced Accuracy     0.497721 0.8783959  0.495466  0.870874

## 
